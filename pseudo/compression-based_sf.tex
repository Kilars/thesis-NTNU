\begin{figure}
    \begin{lstlisting}[
        caption={Psuedocode for reference set construction with spatial filter},
        language=Pascal,
        label=lst:ca_sf,
        numbers=left
    ]
        Input: SampleTrajectories, CompressionThreshold
        Output: (ReferenceSet, RTree)
        ----------------------------------------
        ReferenceSet = []
        RTree = new RTree()

        for ST in SampleTrajectorySet
            CompressionRatio = Compress(ST, ReferenceSet)
            if CompressionRatio < CompressionThreshold 
                i = ReferenceSet.len()
                for (pt, j) in ST
                    RTree.insert(pt, (i, j))
                ReferenceSet.push(ST)

        (ReferenceSet, RTree)
    \end{lstlisting}
\end{figure}