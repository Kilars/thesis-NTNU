\begin{figure}[t]
    \begin{lstlisting}[
        caption={Psuedo code for reference set construction with spatial filter},
        language=Pascal,
        label=lst:ca_sf,
        numbers=left
    ]
        Input: T, rs
        Output: ReferenceSet
        ----------------------------------------
        ReferenceSet = []
        RTree = new RTree()

        for ST in SampleTrajectorySet
            CR = Compress(ST, ReferenceSet)
            if CR < 5 
                i = ReferenceSet.len()
                for (pt, j) in ST
                    RTree.insert(pt, (i, j))
                ReferenceSet.push(ST)

        (ReferenceSet, RTree)
    \end{lstlisting}
\end{figure}